@model nuce.web.survey.student.Models.SurveyResultModel

@{
    ViewBag.Title = "Bộ môn";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Breadcrumb {
    <li class="breadcrumb-item"><a class="m-text-blue" href="/default">Trang chủ</a></li>
    <li class="breadcrumb-item">Kết quả khảo sát</li>
    @if (!string.IsNullOrEmpty(Model.FacultyCode))
    {
        <li class="breadcrumb-item active" aria-current="page">
            <a class="m-text-blue" href="/surveyresult/faculty?code=@Model.FacultyCode">Khoa</a>
        </li>
    }
    <li class="breadcrumb-item active" aria-current="page">
        Bộ môn
    </li>
}
@* Tên bộ môn *@
<h5 class="text-center mb-3 m-text-blue">
    <span>
        @Model.DepartmentCode
    </span>
</h5>

<div class="row">
    <div class="col-12">
        <table id="department-survey-result-datatable"
               data-page-length='25'
               class="table th-border-none">
            <thead>
                <tr>
                    <td>Bộ môn</td>
                    <td>Số sv tham gia khảo sát</td>
                    <td>Số sv được khảo sát</td>
                    <td>Số phiếu thu về</td>
                    <td>Số phiếu ks phát ra</td>
                </tr>
            </thead>
        </table>
    </div>
</div>

@section Scripts {
    <script src="~/content/js/jquery.dataTables.min.js"></script>
    <script src="~/content/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/content/js/dataTables.config.js"></script>
    <script>
        var facultyResultState = {
            userTable: function() {
                return $('#department-survey-result-datatable').DataTable({
                    processing: true,
                    serverSide: true,
                    ordering: false,
                    lengthChange: false,
                    stateSave: true,
                    language: dataTableConfig.language,
                    ajax: {
                        url: `GetDepartmentResult?code=@Model.DepartmentCode`,
                        dataType: 'json',
                        contentType: 'application/json',
                        type: 'post',
                        data: function (d) {
                            return JSON.stringify(d);
                        },
                    },
                    columns: [
                        {
                            data: 'name',
                            mRender: function(data, type, row) {
                                return `<a href="/surveyresult/lecturer?code=${row.LecturerCode}&facultyCode=@Model.FacultyCode&departmentCode=@Model.DepartmentCode">${row.LecturerName}</a>`;
                            },
                        },
                        {
                            data: 'SoSvThamGiaKhaoSat',
                        },
                        {
                            data: 'SoSvDuocKhaoSat',
                        },
                        {
                            data: 'SoPhieuThuVe',
                        },
                        {
                            data: 'SoPhieuPhatRa',
                        },
                    ],
                });
            },
            init: function() {
                facultyResultState.userTable();
                $('#department-survey-result-datatable_filter').hide();
            },
        };
        facultyResultState.init();
    </script>
}



