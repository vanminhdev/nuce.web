@{
    ViewBag.Title = "Quản lý dịch vụ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    @@media only screen and (min-width: 1025px) {
        .service-categories-wrp {
            margin-top: 0;
        }
    }

    .overflow-text {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

<div class="container-fluid service-categories-wrp">
    <div class="row mb-2">
        <div class="col-12 text-right">
            <button type="button" class="btn btn-success"
                    onclick="onExportExcel()">
                Excel
            </button>
        </div>
    </div>
    <div class="row text-center">
        <div class="col-12 col-md-6 col-xl-3">
            Tổng số: <span class="main-color">@(Model[-1].tongSo)</span>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            Mới gửi: <span class="main-color">@(Model[-1].moiGui)</span>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            Đang xử lý: <span class="main-color">@(Model[-1].dangXuLy)</span>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            Đã xử lý xong: <span class="main-color">@(Model[-1].daXuLy)</span>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <hr class="w-100 line mt-2 mb-2" />
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-md-6 col-xl-4 p-1 service-avatar-wrp cursor-pointer">
            <a href="/ctsvservicemanagement/detail?id=1"
               class="row justify-content-center">
                <img src="~/content/images/services/giay-xac-nhan.jpg"
                     alt="service"
                     class="service-avatar col-10" />
                <div class="col-12 mt-2 text-center text-uppercase main-color fw-600 font-14-sm font-18-md font-18 title-service overflow-text">
                    dịch vụ xin giấy xác nhận
                </div>
                <div class="col-12">
                    <hr class="w-100 line mt-2 mb-2" />
                </div>
                <div class="col-10 text-decoration-none">
                    <div class="row">
                        <div class="col-6 pl-0">
                            Tổng số: <span class="main-color">@(Model[1].tongSo)</span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Mới gửi: <span class="main-color">@(Model[1].moiGui)</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 pl-0">
                            Đang xử lý: <span class="main-color">@(Model[1].dangXuLy)</span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Đã xử lý xong: <span class="main-color">@(Model[1].daXuLy)</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-12 col-md-6 col-xl-4 p-1 service-avatar-wrp cursor-pointer">
            <a href="/ctsvservicemanagement/detail?id=8"
               class="row justify-content-center">
                <img src="~/content/images/services/dich-vu-ho-tro.jpg"
                     alt="service"
                     class="service-avatar col-10" />
                <div class="col-10 mt-2 text-center text-uppercase main-color fw-600 font-14-sm font-18-md font-18 title-service  overflow-text">
                    làm vé tháng xe bus
                </div>
                <div class="col-12">
                    <hr class="w-100 line mt-2 mb-2" />
                </div>
                <div class="col-10 text-decoration-none">
                    <div class="row">
                        <div class="col-6 pl-0">
                            Tổng số:
                            <span class="main-color">
                                @(Model[8].tongSo)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Mới gửi:
                            <span class="main-color">
                                @(Model[8].moiGui)
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 pl-0">
                            Đang xử lý:
                            <span class="main-color">
                                @(Model[8].dangXuLy)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Đã xử lý xong:
                            <span class="main-color">
                                @(Model[8].daXuLy)
                            </span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-12 col-md-6 col-xl-4 p-1 service-avatar-wrp cursor-pointer"
             title="vay vốn ngân hàng chính sách - xã hội">
            <a href="/ctsvservicemanagement/detail?id=6"
               class="row justify-content-center">
                <img src="~/content/images/services/VAY_VON.jpg"
                     alt="service"
                     class="service-avatar col-10" />
                <div class="col-10 mt-2 text-center text-uppercase main-color fw-600 font-14-sm font-18-md font-18 title-service  overflow-text">
                    vay vốn ngân hàng chính sách - xã hội
                </div>

                <div class="col-12">
                    <hr class="w-100 line mt-2 mb-2" />
                </div>
                <div class="col-10 text-decoration-none">
                    <div class="row">
                        <div class="col-6 pl-0">
                            Tổng số:
                            <span class="main-color">
                                @(Model[6].tongSo)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Mới gửi:
                            <span class="main-color">
                                @(Model[6].moiGui)
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 pl-0">
                            Đang xử lý:
                            <span class="main-color">
                                @(Model[6].dangXuLy)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Đã xử lý xong:
                            <span class="main-color">
                                @(Model[6].daXuLy)
                            </span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-12 col-md-6 col-xl-4 p-1 service-avatar-wrp cursor-pointer">
            <a href="/ctsvservicemanagement/detail?id=4"
               class="row justify-content-center">
                <img src="~/content/images/services/Uu-dai-giao-duc-Max-Quality.jpg"
                     alt="service"
                     class="service-avatar col-10" />
                <div class="col-10 mt-2 text-center text-uppercase main-color fw-600 font-14-sm font-18-md font-18 title-service overflow-text">
                    ưu đãi trong giáo dục
                </div>
                <div class="col-12">
                    <hr class="w-100 line mt-2 mb-2" />
                </div>
                <div class="col-10 text-decoration-none">
                    <div class="row">
                        <div class="col-6 pl-0">
                            Tổng số:
                            <span class="main-color">
                                @(Model[4].tongSo)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Mới gửi:
                            <span class="main-color">
                                @(Model[4].moiGui)
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 pl-0">
                            Đang xử lý:
                            <span class="main-color">
                                @(Model[4].dangXuLy)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Đã xử lý xong:
                            <span class="main-color">
                                @(Model[4].daXuLy)
                            </span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-12 col-md-6 col-xl-4 p-1 service-avatar-wrp cursor-pointer"
            title="Đăng ký nhà ở KTX Pháp Vân - Tứ Hiệp">
            <a href="/ctsvservicemanagement/detail?id=7"
               class="row justify-content-center">
                <img src="~/content/images/services/KTX.jpg"
                     alt="service"
                     class="service-avatar col-10" />
                <div class="col-10 mt-2 text-center text-uppercase main-color fw-600 font-14-sm font-18-md font-18 title-service overflow-text">
                    Đăng ký nhà ở KTX Pháp Vân - Tứ Hiệp
                </div>
                <div class="col-12">
                    <hr class="w-100 line mt-2 mb-2" />
                </div>
                <div class="col-10 text-decoration-none">
                    <div class="row">
                        <div class="col-6 pl-0">
                            Tổng số:
                            <span class="main-color">
                                @(Model[7].tongSo)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Mới gửi:
                            <span class="main-color">
                                @(Model[7].moiGui)
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 pl-0">
                            Đang xử lý:
                            <span class="main-color">
                                @(Model[7].dangXuLy)
                            </span>
                        </div>
                        <div class="col-6 text-left p-0">
                            Đã xử lý xong:
                            <span class="main-color">
                                @(Model[7].daXuLy)
                            </span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        var onExportExcel = function() {
            callApiExport({
                ExportType: 'excel-ov',
            }, 'xlsx')
        };

        var callApiExport = function(data, format) {
            $.ajax({
                type: 'POST',
                url: `@Url.Action("ExportFile", "CtsvServiceManagement")`,
                data: JSON.stringify(data),
                dataType: 'json',
                contentType: 'application/json',
                success: function(res) {
                    window.location = `/CtsvServiceManagement/DownloadFile?id=${res.fileId}&format=${format}`;
                },
            }).done(res => {
            }).fail(res => {
            });
        };
    </script>
}
